#!/usr/bin/env node

/**
 * Just an elaborate way to execute the command:
 * node server.js | node_modules/bunyan/bin/bunyan
 */

var spawn = require('child_process').spawn;
var path = require('path');

var server = spawn('node', [path.join(__dirname, '../server.js')], { stdio: ['pipe', 'pipe', 'pipe'] });
var bunyan = spawn('node', [path.join(__dirname, '../node_modules/bunyan/bin/bunyan')], { stdio: ['pipe', process.stdout, process.stderr] });

server.stdout.on('data', function (data) {
  bunyan.stdin.write(data);
});
server.stderr.on('data', function (data) {
  bunyan.stderr.write(data);
});